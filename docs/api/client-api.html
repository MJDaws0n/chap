<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chap Platform API Reference</title>
  <link rel="stylesheet" href="/css/api.css" />
</head>
<body>
  <header class="topbar">
    <div class="wrap">
      <div class="brand">Chap Platform API Reference</div>
      <p class="subtitle">Unified test console for Server API v2 and Node API v2</p>
    </div>
  </header>

  <div class="layout">
    <aside class="sidebar">
      <h3>Contents</h3>
      <nav class="nav">
        <a href="#overview">Overview</a>
        <a href="#server-api">Server API v2</a>
        <div class="toc-sub">
          <a href="#server-core">Core</a>
          <a href="#server-tokens">Authentication & Tokens</a>
          <a href="#server-teams">Teams</a>
          <a href="#server-projects">Projects</a>
          <a href="#server-environments">Environments</a>
          <a href="#server-applications">Applications</a>
          <a href="#server-deployments">Deployments</a>
          <a href="#server-templates">Templates</a>
          <a href="#server-nodes">Nodes</a>
        </div>
        <a href="#node-api">Node API v2</a>
        <div class="toc-sub">
          <a href="#node-core">Core</a>
          <a href="#node-apps">Applications & Containers</a>
          <a href="#node-logs">Logs & Metrics</a>
          <a href="#node-volumes">Volumes</a>
          <a href="#node-deployments">Deployments</a>
          <a href="#node-files">Filesystem</a>
        </div>
      </nav>
    </aside>

    <main>
      <section id="overview" class="panel intro">
        <div>
          <h2>Quick Setup</h2>
          <p>All endpoints below are derived from code. Update the base URLs here and every URL block will update automatically, including copy actions.</p>
        </div>
        <div class="inputs">
          <label class="field">
            Server URL
            <input id="server-url" type="text" value="http://localhost:8080" />
          </label>
          <label class="field">
            Node URL
            <input id="node-url" type="text" value="http://localhost:8080" />
          </label>
        </div>
        <div class="callout">Values are saved locally and restored on refresh.</div>
      </section>

      <section id="server-api" class="section">
        <h3>Server API v2 (Client Plane)</h3>
        <p>Authentication uses session tokens and personal access tokens (PATs). Create/update applications separately from deploying them.</p>

        <div id="server-core" class="group">
          <h4>Core</h4>
          <div class="grid">

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Health check (public)</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Basic connectivity check.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-1" data-url="/api/v2/health" data-base="server">http://localhost:8080/api/v2/health</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-1">{}</pre>
          </div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Capabilities (public)</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Discover supported features and limits.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-2" data-url="/api/v2/capabilities" data-base="server">http://localhost:8080/api/v2/capabilities</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-2">{}</pre>
          </div>
        </div>

          </div>
        </div>

        <div id="server-tokens" class="group">
          <h4>Authentication & Tokens</h4>
          <div class="grid">

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Create session token</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Returns a short-lived session token. MFA code required if enabled.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-3" data-url="/api/v2/auth/session" data-base="server">http://localhost:8080/api/v2/auth/session</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-3">{
  "email": "admin@example.com",
  "password": "password123",
  "totp": "123456"
}</pre>
          </div>
          <div class="meta">Headers: Authorization not required.</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Who am I</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Requires a token with scope `settings:read` or `activity:read`.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-4" data-url="/api/v2/me" data-base="server">http://localhost:8080/api/v2/me</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-4">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer SESSION_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Create personal access token (PAT)</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Use a session token that includes `settings:write` scope.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-5" data-url="/api/v2/auth/tokens" data-base="server">http://localhost:8080/api/v2/auth/tokens</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-5">{
  "name": "automation",
  "scopes": [
    "settings:read",
    "settings:write",
    "teams:read",
    "teams:write",
    "projects:read",
    "applications:read",
    "nodes:read",
    "nodes:session:mint"
  ],
  "constraints": null,
  "expires_at": "2026-12-31T00:00:00Z"
}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer SESSION_TOKEN, Idempotency-Key: optional</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>List PATs</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Pagination uses cursor-based `page[limit]` and `page[cursor]`.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-6" data-url="/api/v2/auth/tokens?page[limit]=50" data-base="server">http://localhost:8080/api/v2/auth/tokens?page[limit]=50</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-6">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Revoke PAT</strong>
            </div>
            <span class="method delete">DELETE</span>
          </div>
          <div class="meta">Revokes a token by `token_id`.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-7" data-url="/api/v2/auth/tokens/TOKEN_ID" data-base="server">http://localhost:8080/api/v2/auth/tokens/TOKEN_ID</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-7">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN</div>
        </div>

          </div>
        </div>

        <div id="server-teams" class="group">
          <h4>Teams</h4>
          <div class="grid">

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>List teams</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Returns teams for the current user.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-8" data-url="/api/v2/teams" data-base="server">http://localhost:8080/api/v2/teams</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-8">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Select team</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Sets the active team for the session.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-9" data-url="/api/v2/teams/TEAM_ID/select" data-base="server">http://localhost:8080/api/v2/teams/TEAM_ID/select</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-9">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN</div>
        </div>

          </div>
        </div>

        <div id="server-projects" class="group">
          <h4>Projects</h4>
          <div class="grid">

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>List projects</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Requires a selected team or a filter. Uses cursor pagination.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-10" data-url="/api/v2/projects?filter[team_id]=TEAM_ID&amp;page[limit]=50" data-base="server">http://localhost:8080/api/v2/projects?filter[team_id]=TEAM_ID&amp;page[limit]=50</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-10">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN (or X-Team-Id header)</div>
        </div>

          </div>
        </div>

        <div id="server-environments" class="group">
          <h4>Environments</h4>
          <div class="grid">

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>List environments</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Filter by team and optionally by project.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-200" data-url="/api/v2/environments?filter[team_id]=TEAM_ID&amp;filter[project_id]=PROJECT_ID&amp;page[limit]=50" data-base="server">http://localhost:8080/api/v2/environments?filter[team_id]=TEAM_ID&amp;filter[project_id]=PROJECT_ID&amp;page[limit]=50</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-200">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN (or X-Team-Id header). Scope required: <code>environments:read</code>.</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Get environment</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Fetch details for an environment UUID.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-201" data-url="/api/v2/environments/ENVIRONMENT_ID" data-base="server">http://localhost:8080/api/v2/environments/ENVIRONMENT_ID</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-201">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN. Scope required: <code>environments:read</code>.</div>
        </div>

          </div>
        </div>

        <div id="server-applications" class="group">
          <h4>Applications</h4>
          <div class="grid">

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>List applications</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Lists applications for the selected team. Returns full application UUIDs (required for minting node tokens).</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-101" data-url="/api/v2/applications?filter[team_id]=TEAM_ID&amp;page[limit]=50" data-base="server">http://localhost:8080/api/v2/applications?filter[team_id]=TEAM_ID&amp;page[limit]=50</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-101">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN (or X-Team-Id header). Scope required: <code>applications:read</code>.</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Get application</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Fetch the full stored app config metadata (deploy uses stored config).</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-202" data-url="/api/v2/applications/APP_ID" data-base="server">http://localhost:8080/api/v2/applications/APP_ID</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-202">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN. Scope required: <code>applications:read</code>.</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Create application (stores deploy config)</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Create an app once; future deploys donâ€™t need the settings re-sent.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-203" data-url="/api/v2/environments/ENVIRONMENT_ID/applications" data-base="server">http://localhost:8080/api/v2/environments/ENVIRONMENT_ID/applications</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-203">{
  "name": "Example App",
  "node_id": "NODE_ID",
  "build_pack": "docker-compose",
  "git_repository": "https://github.com/example/repo.git",
  "git_branch": "main",
  "docker_compose_path": "docker-compose.yml",
  "build_context": ".",
  "environment_variables": {
    "HELLO": "world"
  }
}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN. Scope required: <code>applications:write</code>.</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Update application (changes stored deploy config)</strong>
            </div>
            <span class="method patch">PATCH</span>
          </div>
          <div class="meta">Update app settings without deploying; deploy separately.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-204" data-url="/api/v2/applications/APP_ID" data-base="server">http://localhost:8080/api/v2/applications/APP_ID</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-204">{
  "git_branch": "main",
  "environment_variables": {
    "HELLO": "chap"
  }
}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN. Scope required: <code>applications:write</code>.</div>
        </div>

          </div>
        </div>

        <div id="server-deployments" class="group">
          <h4>Deployments</h4>
          <div class="grid">

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Deploy application (uses stored config)</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Queues a new deployment without re-sending app settings.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-205" data-url="/api/v2/applications/APP_ID/deployments" data-base="server">http://localhost:8080/api/v2/applications/APP_ID/deployments</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-205">{
  "commit_sha": null
}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN. Scope required: <code>applications:deploy</code>.</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>List deployments for application</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Cursor pagination supported.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-206" data-url="/api/v2/applications/APP_ID/deployments?page[limit]=50" data-base="server">http://localhost:8080/api/v2/applications/APP_ID/deployments?page[limit]=50</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-206">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN. Scope required: <code>deployments:read</code>.</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Get deployment</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-207" data-url="/api/v2/deployments/DEPLOYMENT_ID" data-base="server">http://localhost:8080/api/v2/deployments/DEPLOYMENT_ID</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-207">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN. Scope required: <code>deployments:read</code>.</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Get deployment logs</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-208" data-url="/api/v2/deployments/DEPLOYMENT_ID/logs" data-base="server">http://localhost:8080/api/v2/deployments/DEPLOYMENT_ID/logs</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-208">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN. Scope required: <code>deployments:read</code>.</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Cancel deployment</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-209" data-url="/api/v2/deployments/DEPLOYMENT_ID/cancel" data-base="server">http://localhost:8080/api/v2/deployments/DEPLOYMENT_ID/cancel</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-209">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN. Scope required: <code>deployments:write</code> or <code>deployments:cancel</code>.</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Rollback to deployment</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-210" data-url="/api/v2/deployments/DEPLOYMENT_ID/rollback" data-base="server">http://localhost:8080/api/v2/deployments/DEPLOYMENT_ID/rollback</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-210">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN. Scope required: <code>deployments:write</code> or <code>deployments:rollback</code>.</div>
        </div>

          </div>
        </div>

        <div id="server-templates" class="group">
          <h4>Templates</h4>
          <div class="grid">

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>List templates</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Templates are global but require a team context for permission checks.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-211" data-url="/api/v2/templates?filter[team_id]=TEAM_ID" data-base="server">http://localhost:8080/api/v2/templates?filter[team_id]=TEAM_ID</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-211">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN. Scope required: <code>templates:read</code>.</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Get template</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-212" data-url="/api/v2/templates/TEMPLATE_SLUG" data-base="server">http://localhost:8080/api/v2/templates/TEMPLATE_SLUG</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-212">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN. Scope required: <code>templates:read</code>.</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Deploy from template (create app + optional initial deploy)</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Creates an application from the template. By default, queues an initial deployment; set <code>deploy</code> to <code>false</code> to create without deploying.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-213" data-url="/api/v2/templates/TEMPLATE_SLUG/deploy" data-base="server">http://localhost:8080/api/v2/templates/TEMPLATE_SLUG/deploy</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-213">{
  "name": "My Template App",
  "environment_id": "ENVIRONMENT_ID",
  "node_id": "NODE_ID",
  "deploy": true,
  "cpu_limit": "1",
  "memory_limit": "512m",
  "environment_variables": {
    "REQUIRED_VAR": "value"
  }
}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN. Scope required: <code>templates:deploy</code>. Notes: templates may include dynamic placeholders like <code>{ram}</code> and <code>{port[0]}</code>; this endpoint derives RAM/CPU from effective limits (defaults shown above) and auto-reserves any required ports for the template. If <code>deploy</code> is <code>false</code>, response includes <code>deployment: null</code>.</div>
        </div>

          </div>
        </div>

          </div>

        <div id="server-nodes" class="group">
          <h4>Nodes</h4>
          <div class="grid">

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>List nodes</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Lists all nodes the user can access.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-11" data-url="/api/v2/nodes" data-base="server">http://localhost:8080/api/v2/nodes</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-11">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Get node details</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Use the node UUID from Step 11.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-12" data-url="/api/v2/nodes/NODE_ID" data-base="server">http://localhost:8080/api/v2/nodes/NODE_ID</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-12">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Mint node access token</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Returns `node_access_token` for Node API v2. Must include `constraints.application_id`.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-13" data-url="/api/v2/nodes/NODE_ID/sessions" data-base="server">http://localhost:8080/api/v2/nodes/NODE_ID/sessions</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-13">{
  "scopes": [
    "applications:read",
    "applications:deploy",
    "containers:read",
    "containers:write",
    "logs:read",
    "logs:stream",
    "metrics:read",
    "volumes:read",
    "volumes:write",
    "files:read",
    "files:write",
    "files:delete"
  ],
  "constraints": {
    "application_id": "APP_ID",
    "paths": ["/app", "/data"],
    "max_bytes": 1048576
  },
  "ttl_sec": 120
}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer PAT_TOKEN</div>
        </div>
      </div>
    </section>

    <section id="node-api" class="section">
      <h3>Node API v2 (Node Plane)</h3>
      <p>Use the Node URL input above. The endpoints below require a minted node access token.</p>
      <div class="callout" style="margin-bottom: 12px;">
        Tip: use <code>GET /api/v2/applications</code> (Server API v2) to fetch the full application UUID required for <code>constraints.application_id</code>. Short IDs will not work.
      </div>

      <div id="node-core" class="group">
        <h4>Core</h4>
        <div class="grid">
        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Node health (public)</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Optional pre-check for the node plane.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-14" data-url="/node/v2/health" data-base="node">http://localhost:8080/node/v2/health</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-14">{}</pre>
          </div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Node capabilities (public)</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Lists node plane features.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-15" data-url="/node/v2/capabilities" data-base="node">http://localhost:8080/node/v2/capabilities</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-15">{}</pre>
          </div>
        </div>

        </div>
      </div>

      <div id="node-apps" class="group">
        <h4>Applications & Containers</h4>
        <div class="grid">

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>List applications</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Requires Node access token with `applications:read`.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-16" data-url="/node/v2/applications" data-base="node">http://localhost:8080/node/v2/applications</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-16">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Application status</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Shows containers for a single application.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-17" data-url="/node/v2/applications/APP_ID/status" data-base="node">http://localhost:8080/node/v2/applications/APP_ID/status</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-17">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>List containers</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Filter by application ID using `filter[application_id]`.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-18" data-url="/node/v2/containers?filter[application_id]=APP_ID" data-base="node">http://localhost:8080/node/v2/containers?filter[application_id]=APP_ID</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-18">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Inspect container</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Use a container ID from Step 18.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-19" data-url="/node/v2/containers/CONTAINER_ID" data-base="node">http://localhost:8080/node/v2/containers/CONTAINER_ID</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-19">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Restart container</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Use with caution. Restarts the container.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-20" data-url="/node/v2/containers/CONTAINER_ID:restart" data-base="node">http://localhost:8080/node/v2/containers/CONTAINER_ID:restart</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-20">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Stop container</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Stops the container gracefully.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-21" data-url="/node/v2/containers/CONTAINER_ID:stop" data-base="node">http://localhost:8080/node/v2/containers/CONTAINER_ID:stop</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-21">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        </div>
      </div>

      <div id="node-logs" class="group">
        <h4>Logs & Metrics</h4>
        <div class="grid">

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Container logs</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Returns plain log text in JSON.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-22" data-url="/node/v2/containers/CONTAINER_ID/logs?tail=200&amp;since=2025-01-01T00:00:00Z" data-base="node">http://localhost:8080/node/v2/containers/CONTAINER_ID/logs?tail=200&amp;since=2025-01-01T00:00:00Z</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-22">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Stream logs (SSE)</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Opens a server-sent events stream.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-23" data-url="/node/v2/containers/CONTAINER_ID/logs/stream?tail=200" data-base="node">http://localhost:8080/node/v2/containers/CONTAINER_ID/logs/stream?tail=200</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-23">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Host metrics</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">CPU, memory, disk, uptime.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-24" data-url="/node/v2/metrics/host" data-base="node">http://localhost:8080/node/v2/metrics/host</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-24">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Containers metrics (all)</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Summary stats for all containers.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-25" data-url="/node/v2/metrics/containers" data-base="node">http://localhost:8080/node/v2/metrics/containers</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-25">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Container metrics (single)</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Target a specific container.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-26" data-url="/node/v2/metrics/containers/CONTAINER_ID" data-base="node">http://localhost:8080/node/v2/metrics/containers/CONTAINER_ID</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-26">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        </div>
      </div>

      <div id="node-volumes" class="group">
        <h4>Volumes</h4>
        <div class="grid">

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>List volumes</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Requires an application-bound node token.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-27" data-url="/node/v2/volumes" data-base="node">http://localhost:8080/node/v2/volumes</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-27">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Attach volume</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Logical attach (no payload required).</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-28" data-url="/node/v2/volumes/VOLUME_ID:attach" data-base="node">http://localhost:8080/node/v2/volumes/VOLUME_ID:attach</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-28">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Detach volume</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Logical detach (no payload required).</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-29" data-url="/node/v2/volumes/VOLUME_ID:detach" data-base="node">http://localhost:8080/node/v2/volumes/VOLUME_ID:detach</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-29">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Snapshot volume</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Creates a snapshot ID.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-30" data-url="/node/v2/volumes/VOLUME_ID:snapshot" data-base="node">http://localhost:8080/node/v2/volumes/VOLUME_ID:snapshot</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-30">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        </div>
      </div>

      <div id="node-deployments" class="group">
        <h4>Deployments</h4>
        <div class="callout" style="margin-bottom: 12px;">
          Disclaimer: deployment endpoints below are not final and will change. Use these examples only for current testing.
        </div>
        <div class="grid">

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Start deployment</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Kicks off an async deployment job.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-31" data-url="/node/v2/deployments" data-base="node">http://localhost:8080/node/v2/deployments</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-31">{
  "deployment_id": "dep_12345",
  "application_id": "APP_ID",
  "application": {
    "id": "APP_ID",
    "uuid": "APP_ID",
    "name": "Example App",
    "environment": {
      "id": "env_123",
      "name": "Production"
    },
    "compose": {
      "services": {
        "web": {
          "image": "nginx:alpine",
          "ports": ["8080:80"]
        }
      }
    }
  }
}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Deployment status</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Check the job status by deployment ID.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-32" data-url="/node/v2/deployments/dep_12345" data-base="node">http://localhost:8080/node/v2/deployments/dep_12345</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-32">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Cancel deployment</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Cancels a running job.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-33" data-url="/node/v2/deployments/dep_12345:cancel" data-base="node">http://localhost:8080/node/v2/deployments/dep_12345:cancel</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-33">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        </div>
      </div>

      <div id="node-files" class="group">
        <h4>Filesystem</h4>
        <div class="grid">

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Create directory</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Creates a folder in the application filesystem.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-34" data-url="/node/v2/fs/mkdir" data-base="node">http://localhost:8080/node/v2/fs/mkdir</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-34">{
  "path": "/app/data"
}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Write file</strong>
            </div>
            <span class="method put">PUT</span>
          </div>
          <div class="meta">Content must be base64 encoded.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-35" data-url="/node/v2/fs/write" data-base="node">http://localhost:8080/node/v2/fs/write</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-35">{
  "path": "/app/data/hello.txt",
  "content_base64": "SGVsbG8gQ2hhcA==",
  "atomic": true,
  "mode": "0644"
}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>List files</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">List directory contents.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-36" data-url="/node/v2/fs/ls?path=/app&amp;recursive=false&amp;limit=2000" data-base="node">http://localhost:8080/node/v2/fs/ls?path=/app&amp;recursive=false&amp;limit=2000</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-36">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Stat file</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Check size, mode, mtime.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-37" data-url="/node/v2/fs/stat?path=/app/data/hello.txt" data-base="node">http://localhost:8080/node/v2/fs/stat?path=/app/data/hello.txt</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-37">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Read file</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Use `length=0` to read full file (within max bytes).</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-38" data-url="/node/v2/fs/read?path=/app/data/hello.txt&amp;offset=0&amp;length=0" data-base="node">http://localhost:8080/node/v2/fs/read?path=/app/data/hello.txt&amp;offset=0&amp;length=0</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-38">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Copy file</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Creates a duplicate path.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-39" data-url="/node/v2/fs/copy" data-base="node">http://localhost:8080/node/v2/fs/copy</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-39">{
  "from": "/app/data/hello.txt",
  "to": "/app/data/hello.copy.txt",
  "overwrite": true
}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Move file</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Moves or renames files.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-40" data-url="/node/v2/fs/move" data-base="node">http://localhost:8080/node/v2/fs/move</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-40">{
  "from": "/app/data/hello.copy.txt",
  "to": "/app/data/hello.moved.txt",
  "overwrite": true
}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Change permissions</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Octal mode string.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-41" data-url="/node/v2/fs/chmod" data-base="node">http://localhost:8080/node/v2/fs/chmod</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-41">{
  "path": "/app/data/hello.moved.txt",
  "mode": "0644"
}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Download file or directory</strong>
            </div>
            <span class="method get">GET</span>
          </div>
          <div class="meta">Returns binary for files; JSON for directories.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-42" data-url="/node/v2/fs/download?path=/app/data/hello.moved.txt" data-base="node">http://localhost:8080/node/v2/fs/download?path=/app/data/hello.moved.txt</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-42">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Delete file or directory</strong>
            </div>
            <span class="method delete">DELETE</span>
          </div>
          <div class="meta">Deletes recursively.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-43" data-url="/node/v2/fs/delete?path=/app/data/hello.moved.txt" data-base="node">http://localhost:8080/node/v2/fs/delete?path=/app/data/hello.moved.txt</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON</div>
            <pre class="code" id="payload-43">{}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN</div>
        </div>

        <div class="endpoint">
          <div class="endpoint-header">
            <div>
              <strong>Upload file (multipart)</strong>
            </div>
            <span class="method post">POST</span>
          </div>
          <div class="meta">Send multipart form data with fields: `path` and `file`.</div>
          <div class="row">
            <div class="row-label">URL</div>
            <div class="code" id="url-44" data-url="/node/v2/fs/upload" data-base="node">http://localhost:8080/node/v2/fs/upload</div>
          </div>
          <div class="row">
            <div class="row-label">Payload JSON (descriptor)</div>
            <pre class="code" id="payload-44">{
  "multipart": {
    "path": "/app/data/upload.txt",
    "file": "<binary file bytes>"
  }
}</pre>
          </div>
          <div class="meta">Headers: Authorization: Bearer NODE_ACCESS_TOKEN, Content-Type: multipart/form-data</div>
        </div>
      </div>
    </div>
    </section>
  </main>
 
        </div>
</div>

  <div class="toast" id="toast">Copied</div>

  <script>
    const toast = document.getElementById('toast');
    const serverInput = document.getElementById('server-url');
    const nodeInput = document.getElementById('node-url');
    const storageKeys = {
      server: 'chap.serverUrl',
      node: 'chap.nodeUrl',
    };

    let toastTimer;

    function normalizeBase(value) {
      return String(value || '').trim().replace(/\/$/, '');
    }

    function updateUrls() {
      const serverBase = normalizeBase(serverInput.value || '');
      const nodeBase = normalizeBase(nodeInput.value || '');

      document.querySelectorAll('[data-url]').forEach((el) => {
        const path = el.getAttribute('data-url') || '';
        const baseType = el.getAttribute('data-base');
        const base = baseType === 'node' ? nodeBase : serverBase;
        el.textContent = base + path;
      });
    }

    function loadStoredInputs() {
      const storedServer = localStorage.getItem(storageKeys.server);
      const storedNode = localStorage.getItem(storageKeys.node);
      if (storedServer) serverInput.value = storedServer;
      if (storedNode) nodeInput.value = storedNode;
    }

    function persistInputs() {
      localStorage.setItem(storageKeys.server, serverInput.value.trim());
      localStorage.setItem(storageKeys.node, nodeInput.value.trim());
    }

    function showToast(message) {
      toast.textContent = message;
      toast.classList.add('show');
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => toast.classList.remove('show'), 1200);
    }

    async function copyText(text) {
      try {
        await navigator.clipboard.writeText(text);
        showToast('Copied to clipboard');
      } catch (err) {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        showToast('Copied to clipboard');
      }
    }

    document.querySelectorAll('.code').forEach((el) => {
      el.classList.add('copyable');
      el.setAttribute('title', 'Click to copy');
      el.addEventListener('click', () => {
        copyText(el.textContent.trim());
      });
    });

    loadStoredInputs();
    updateUrls();
    persistInputs();

    serverInput.addEventListener('input', () => {
      persistInputs();
      updateUrls();
    });
    nodeInput.addEventListener('input', () => {
      persistInputs();
      updateUrls();
    });
  </script>
</body>
</html>
